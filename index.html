<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Analisador de Texto com IA</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container mt-5">
  <h2 class="mb-3">Analisador de Texto com IA</h2>
  <textarea id="textInput" class="form-control" rows="6" placeholder="Cole o texto aqui..."></textarea>
  <button class="btn btn-primary mt-3" onclick="analyze()">Analisar</button>
  <div id="result" class="mt-4"></div>
</div>
<script>
function analyze(){
  const text = document.getElementById('textInput').value;
  fetch('http://127.0.0.1:5000/analyze', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({text})
  })
  .then(r => r.json())
  .then(data => {
    if(data.error){
      document.getElementById('result').innerHTML = '<div class="alert alert-warning">'+data.error+'</div>';
      return;
    }
    const pii = data.pii || {};
    let piiText = Object.keys(pii).length ?
      Object.entries(pii).map(([k,v]) => k+': '+v.join(', ')).join('<br>') : 'Nenhum PII detectado';
    document.getElementById('result').innerHTML =
      `<div class="card p-3">
         <h5>Risco: ${data.risk}</h5>
         <p>Confiança: ${(data.confidence*100).toFixed(1)}%</p>
         <p>PII detectado:<br>${piiText}</p>
       </div>`;
  })
  .catch(err=>{
    document.getElementById('result').innerHTML='<div class="alert alert-danger">Erro ao conectar à API.</div>';
    console.error(err);
  });
}
</script>
</body>
</html>
